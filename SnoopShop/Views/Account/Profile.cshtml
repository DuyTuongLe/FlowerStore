@model IEnumerable<SnoopShop.Models.mUser>
@*@model TranAnhShop.Models.mUser*@
@{ ViewBag.Title = Session["User_Name"];
    Layout = "~/Views/Shared/_LayoutSite.cshtml"; }
@Html.Partial("_Nofit")
<script src="~/Public/js/target.min.js"></script>
<script src="~/Public/js/sweetalert2@9.js"></script>
<div style="background:#f5f5f5; min-height:32rem">
    <div class="container-91 mx-auto">
        <div class="row">
            <div class="col-3 mt-5">
                <!--<div class="">
                    <div class="float-left">-->
                        @*<img src="images/boxed-bg.png" ralt="" width="50"
                            class="rounded-circle">*@
                    <!--</div>
                    <div class="float-left pl-3 border-bottom">

                        <small class="font-weight-bold">Hồ sơ cá nhân</small><br>
                        <a href="account/editaccount">-->
                            @*<small class="text-secondary">
                                <i class="fas fa-pen fa-sm"></i>
                                Sửa hồ sơ
                            </small>*@
                        <!--</a>

                    </div>
                </div>
                <br>
                <div style="clear:both"></div>
                <div class="mt-4 pl-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link  text-secondary" href="profile" style="font-size: 14px;">
                                <i class="far fa-id-card"></i> Thông tin tài khoản
                            </a>
                        </li>-->
                        
                        
                        @*<li class="nav-item">
                                <a class="nav-link text-secondary" href="notification" style="font-size: 14px;">
                                    <i class="far fa-bell"></i>&nbsp
                                    Thông báo
                                </a>
                            </li>*@
                        <!--<li class="nav-item ">
                            <a class="nav-link text-secondary" href="javascript:void(0)" style="font-size: 14px;">
                                <i class="fas fa-sign-out-alt"></i>&nbsp Đăng xuất
                            </a>
                        </li>
                    </ul>
                </div>-->

            </div>
            <div class="col-9 bg- mt-3" style="width:50rem; margin-left:-50px">
                <div class="list-group flex-sm-row" id="listtab-order" role="tablist">
                    <button class="text-center list-group-item list-group-item-action active" data-toggle="list" href="#home" role="tab">Tất cả</button>
                    <button class="text-center list-group-item list-group-item-action" id="Button" onclick="Me();" data-toggle="list" href="#profile" role="tab"> </button>
                    <button class="text-center list-group-item list-group-item-action" id="Button1" onclick="Me();" data-toggle="list" href="#messages" role="tab"> </button>
                    <button class="text-center list-group-item list-group-item-action" id="Button2" onclick="Me();" data-toggle="list" href="#settings" role="tab"> </button>
                </div>

                <div class="tab-content flex-sm-row mt-2">
                    <div class="tab-content flex-sm-row mt-2">
                        <li class="tab-pane active" id="home" role="tabpanel">
                            <div class="my-2" style="background-color: white;">
                                <br />
                                <div class="row p-3" style="">
                                    @*<div class="col-4">
                                        <label for="email">Tên truy cập</label>
                                        <input class="mb-0 form-control" type="text" placeholder="Tên truy cập" value="@Session["User_Phone"]" name="Username" disabled />
                                    </div>*@

                                    <div class="col-4">
                                        <label for="email">Họ và Tên</label>
                                        <input class="mb-0 form-control" type="text" placeholder="Họ và Tên" value="@Session["User_Name"]" name="Name" disabled>
                                    </div>

                                    @*<div class="col-4">
                                        <label>Số điện thoại</label>
                                        <input class="mb-0 form-control" type="text" placeholder="Số điện thoại" value="@Session["User_Phone"]" name="Phone" disabled />
                                    </div>*@

                                    <div class="col-4">
                                        <label for="email">Email</label>
                                        <input class="mb-0 form-control" type="email" placeholder="Email" value="@Session["Email_Name"]" name="Email" disabled>

                                    </div>
                                    <div class="col-4">
                                        <label for="email">Địa chỉ</label>
                                        <input class="mb-0 form-control" type="text" placeholder="Địa chỉ" value="@Session["Address_Name"]" name="Address" disabled>

                                    </div>
                                </div>
                                <br />
                                <div class="row">

                                    <div class="col-5">

                                    </div>
                                    <div class="col-7 pt-2 pb-3">
                                        <div class="text-right mr-3">
                                            <!--</button>-->
                                            @foreach (var item in Model.Take(1))
                                            {
                                            <button>
                                                <small class="text-white text">
                                                    <i style="color:white">
                                                        @Html.ActionLink("Chỉnh sửa", "EditCustomer",
                                                            new { id = @Session["User_ID"] }, 
                                                            new { @class = "btn rounded-0 px-5 py-2", @style = "background:#ee4d2d, color:white" })
                                                    </i>
                                                </small>
                                            </button>
                                            }
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                    </div>
                    <li class="tab-pane" id="profile" role="tabpanel">...</li>
                    <li class="tab-pane" id="messages" role="tabpanel">...</li>
                    <li class="tab-pane" id="settings" role="tabpanel">...</li>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    $('#btn_register').click(function (e) {
        e.preventDefault();
        @*alert("OK")*@
        $.ajax({
            url: "account/register",
            type: "POST",
            data: {
                user: {
                    Email: $('#Email').val(),
                    Address: $('#Address').val(),
                    Fullname: $('#Fullname').val(),
                    Name: $('#Name').val(),// dùng tạm, sau xóa luôn cột này đi
                    Password: $('#Pass').val(),
                    Phone: $('.Phone8').val(),
                    //update
                    FirstName: $('#FirstName').val(),
                    LastName: $('#LastName').val(),
                    EmailID: $('#EmailID').val(),
                    File: $('#file').val(),
                }
            },
            dataType: 'json',
            success: function (data) {
                if (data.Code == 0) {
                    $('#exampleModaledit').modal("hide")
                    swal({
                        icon: "success",
                        title: data.Message,
                        timer: 5000
                    });
                    return;
                } else if(data.Code == 1) {
                    swal({
                        icon: "warning",
                        title: data.Message,
                        timer: 5000
                    });
                    return;
                }
                swal({
                    icon: "warning",
                    title: data.Message,
                    timer: 5000
                });
            }
        })
    })
</script>


<style>
    #listtab-order .active {
        border-bottom: 3px solid #ee4d2d;
        background: #fff;
        color: #ee4d2d;
        border-top: 0;
        border-left: 0;
        border-right: 0;
    }

    .list-group-item {
        border-bottom: 1px solid #eee;
        border-top: 0;
        border-left: 0;
        border-right: 0;
    }

    .vertical-center {
        margin: 0 auto;
        position: absolute;
        top: 50%;
        -ms-transform: translateY(-50%);
        transform: translateY(-50%);
    }
</style>
<script>
    document.getElementById("Button").disabled = true;
    document.getElementById("Button1").disabled = true;
    document.getElementById("Button2").disabled = true;
</script>
<script>

    function editProfile() {

        var pass1 = $("#psw").val();
        var pass2 = $("#repeat-password").val();

        if (pass1 != pass2) {
            $("#error").text("2 mật khẩu không khớp");

            return false;
        }

        var data = $("#form_editprofile").serialize();
        $.ajax({
            url: '/Account/Profile',
            type: 'POST',
            data: data,
            dataType: 'json',
            success: function (data) {
                if (data.statuss == 1) {
                    alertify.error("<span class='font-weight-bold'>Thông báo: </span>Mật khẩu không đúng");
                    return false;
                }
                else if (data.statuss == 2) {
                    alertify.error("<span class='font-weight-bold'>Thông báo: </span>Tên đăng nhập đã tồn tại");
                    return false;
                }
                else if (data.statuss == 3) {
                    alertify.error("<span class='font-weight-bold'>Thông báo: </span>Cập nhật thất bại");
                    return false;
                }
                else {
                    $("#unameSess").text(data.username);
                    $("#1_fullname").text(data.fullname);
                    $("#2_fullname").text(data.fullname);
                    alertify.success("<span class='font-weight-bold'>Thông báo:</span> Cập nhật thành công");
                }

            },
            error: function (e) {
                alertify.error("<span class='font-weight-bold'>Thông báo: </span>Lỗi: " + e.statusText);
                return false;
            }
        })
    }
</script>


<script>
    $(function () {
        $('#notready').click(function (e) {
            e.preventDefault();
            Swal.fire({
                icon: 'warning',
                title: 'Chức năng chưa sẵn sàng!',
                timer: 5000
            })
        })
    })
</script>
<script>
    $('#btn_register').click(function (e) {
        e.preventDefault();
        @*alert("OK")*@
        $.ajax({
            url: "account/register",
            type: "POST",
            data: {
                user: {
                    Email: $('#Email').val(),
                    Address: $('#Address').val(),
                    Fullname: $('#Fullname').val(),
                    Name: $('#Name').val(),// dùng tạm, sau xóa luôn cột này đi
                    Password: $('#Pass').val(),
                    Phone: $('.Phone8').val(),
                    //update
                    FirstName: $('#FirstName').val(),
                    LastName: $('#LastName').val(),
                    EmailID: $('#EmailID').val(),
                    File: $('#file').val(),
                }
            },
            dataType: 'json',
            success: function (data) {
                if (data.Code == 0) {
                    $('#exampleModal').modal("hide")
                    swal({
                        icon: "success",
                        title: data.Message,
                        timer: 5000
                    });
                    return;
                } else if(data.Code == 1) {
                    swal({
                        icon: "warning",
                        title: data.Message,
                        timer: 5000
                    });
                    return;
                }
                swal({
                    icon: "warning",
                    title: data.Message,
                    timer: 5000
                });
            }
        })
    })
</script>
